<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Jadwal Sholat Digital</title>

<style>
body {
  margin: 0;
  font-family: Arial, sans-serif;
  background: linear-gradient(to bottom, #0f172a, #020617);
  color: white;
  text-align: center;
}

.jam {
  font-size: 80px;
  font-weight: bold;
  margin-top: 30px;
  color: #22d3ee;
}

.tanggal {
  font-size: 22px;
  margin-bottom: 20px;
}

.container {
  display: flex;
  justify-content: center;
  flex-wrap: wrap;
  gap: 20px;
  padding: 20px;
}

.card {
  background: #1e293b;
  padding: 20px;
  border-radius: 20px;
  width: 180px;
  font-size: 22px;
}

.active {
  background: #16a34a;
  transform: scale(1.05);
}

.countdown {
  font-size: 28px;
  margin-top: 20px;
  color: #facc15;
}

button {
  margin-top: 20px;
  padding: 12px 25px;
  border-radius: 12px;
  border: none;
  font-size: 18px;
  background: #ef4444;
  color: white;
  cursor: pointer;
}
</style>
</head>

<body>

<div class="jam" id="jam"></div>
<div class="tanggal" id="tanggal"></div>

<div class="container" id="jadwal"></div>

<div class="countdown" id="countdown"></div>

<button onclick="aktifkanAlarm()">ðŸ”” Aktifkan Alarm</button>

<audio id="adzanAudio" src="https://www.islamcan.com/audio/adhan/azan1.mp3"></audio>

<script>
let jadwal = {};
let alarmAktif = false;

function updateJam() {
  const now = new Date();
  const jam = now.toLocaleTimeString('id-ID');
  const tanggal = now.toLocaleDateString('id-ID', { weekday:'long', year:'numeric', month:'long', day:'numeric' });

  document.getElementById("jam").innerHTML = jam;
  document.getElementById("tanggal").innerHTML = tanggal;
}

setInterval(updateJam, 1000);
updateJam();

function loadJadwal(lat, lon) {
  fetch(`https://api.aladhan.com/v1/timings?latitude=${lat}&longitude=${lon}&method=11`)
  .then(res => res.json())
  .then(data => {

    const t = data.data.timings;

    jadwal = {
      Subuh: t.Fajr,
      Dzuhur: t.Dhuhr,
      Ashar: t.Asr,
      Maghrib: t.Maghrib,
      Isya: t.Isha
    };

    tampilkanJadwal();
  });
}

function tampilkanJadwal() {
  const container = document.getElementById("jadwal");
  container.innerHTML = "";

  for (let nama in jadwal) {
    container.innerHTML += `
      <div class="card" id="${nama}">
        <div>${nama}</div>
        <div>${jadwal[nama]}</div>
      </div>
    `;
  }
}

function cekWaktu() {
  const now = new Date();
  const jamSekarang = now.toTimeString().slice(0,5);

  let waktuBerikut = null;

  for (let nama in jadwal) {
    if (jamSekarang === jadwal[nama]) {
      if (alarmAktif) {
        document.getElementById("adzanAudio").play();
      }
      document.getElementById(nama).classList.add("active");
    } else {
      const card = document.getElementById(nama);
      if (card) card.classList.remove("active");
    }

    if (jamSekarang < jadwal[nama] && !waktuBerikut) {
      waktuBerikut = {nama, waktu: jadwal[nama]};
    }
  }

  if (waktuBerikut) {
    document.getElementById("countdown").innerHTML =
      "Menuju " + waktuBerikut.nama + " : " + waktuBerikut.waktu;
  }
}

setInterval(cekWaktu, 1000);

function aktifkanAlarm() {
  alarmAktif = true;
  alert("Alarm Aktif âœ…");
}

navigator.geolocation.getCurrentPosition(pos => {
  loadJadwal(pos.coords.latitude, pos.coords.longitude);
});
</script>

</body>
</html>